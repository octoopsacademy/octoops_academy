FROM tomcat:9.0-jdk17

# Install Maven
RUN apt-get update && \
    apt-get install -y maven && \
    apt-get clean

# Set working directory
WORKDIR /usr/src/app

# Copy project files into the image
COPY . .

# Build the WAR inside the container
RUN mvn clean package

# Clean default Tomcat webapps
RUN rm -rf /usr/local/tomcat/webapps/*

# Deploy WAR to Tomcat
RUN cp target/*.war /usr/local/tomcat/webapps/ROOT.war

EXPOSE 8080

CMD ["catalina.sh", "run"]

